<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>InfoV</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<script src="libraries/jquery-1.9.1.min.js"></script>
	<script src="libraries/processing-1.4.1.min.js"></script>
	<script src="libraries/moment.min.js"></script>
	<script src="Zeit_API_Request_Builder.js"></script>
	<script src="Initial_Requests.js"></script>
	
	<script type="text/javascript">
	var scale 			= 1.00;
	var translateX 		= 5;
	var translateY		= 0;
	var value1Array;
	
	
	// Main Programm, startet wenn inistial Request geladen sind.
	function mainProgramm(){
	
		$(document).ready(function(){
			var x 				= $(window).width()/terrorArray.length;
			var y				= 0;
			var positionArray 	= new Array();
			var sketch 			= new Processing.Sketch();
			value1Array			= new Array();
			
			for(var i=0; i < terrorArray.length; i++){
				positionArray.push([x,y]);
				x = x + ($(window).width()/terrorArray.length*.90);
			}
			
			$('#scale').change(function(){
				scale = this.value;
			});
			
			$('#translateX').change(function(){
				translateX = -this.value;
			});
			
			$('#value1').change(function() {
				var value1Request = new Zeit_API_Request_Builder('content','6e499da47fcb281145e490fb6fba3d02028ba8c83af1f50383ee', this.value + '&release_date:[1980-01-01T00:00:00Z TO 2012-12-31T23:59:59.999Z]','1year');
				value1Request.getTopicArray(function(tempArray){
					value1Array = tempArray;
				});
			});
			
			sketch.attachFunction = function(processing) {
				  
				  processing.setup = function() {
					processing.size($(window).width(),500);
					processing.noStroke();
					processing.smooth();
					processing.scale(scale);
					//processing.pushMatrix();
				  };
				  
				  processing.draw = function() {
						processing.background(242,237,228);
						processing.scale(scale);
						processing.translate(translateX,0);
						
						/*
						for(var i=0; i < terrorArray.length; i++){
							if(i%3 == 0){
								drawYear(processing,positionArray[i][0],translateY,terrorArray[i][0],terrorArray[i][1],wahlArray[i][1],angstArray[i][1],waffenArray[i][1]);
							}
							
							else if(i%3 == 1){
								//translateY = 150
								drawYear(processing,positionArray[i][0],translateY,terrorArray[i][0],terrorArray[i][1],wahlArray[i][1],angstArray[i][1],waffenArray[i][1]);
							}
							else{
								//translateY = -150
								drawYear(processing,positionArray[i][0],translateY,terrorArray[i][0],terrorArray[i][1],wahlArray[i][1],angstArray[i][1],waffenArray[i][1]);
							};
							translateY = 0;
						};
						*/
						for(var i=0; i < terrorArray.length; i++){
							drawYear(processing,positionArray[i][0],positionArray[i][1],terrorArray[i][1],wahlArray[i][1],angstArray[i][1],waffenArray[i][1],terrorArray[i][0]);
						}
				  };
				  
			};

			var canvas = document.getElementById("myCanvas");
			// attaching the sketch to the canvas
			var p = new Processing(canvas, sketch);
			
		});
		
	};
	
	function drawYear(processing, startPointX, startPointY, value1, value2, value3, value4, year){
		var distanz = processing.height/5;
		
		processing.pushMatrix();
		//Anfangsposition festlegen
		processing.translate(startPointX-20,startPointY);
		processing.pushMatrix();
		processing.strokeWeight(2);
		processing.stroke(140,134,129,20);
		processing.line(startPointX,startPointY,startPointX,processing.height);
		//Value 1
		processing.translate(startPointX,distanz);
		processing.fill(33,51,49,190);
		processing.ellipseMode(processing.CENTER)
		processing.ellipse(0,0,value1,value1);
		processing.popMatrix();
		// Value 2
		processing.pushMatrix();
		processing.translate(startPointX,distanz*2);
		processing.fill(224,209,163,190);
		processing.ellipseMode(processing.CENTER)
		processing.ellipse(0,0,value2,value2);
		processing.popMatrix();
		//Value 3
		processing.pushMatrix();
		processing.translate(startPointX,distanz*3);
		processing.fill(94,125,77,190);
		processing.ellipseMode(processing.CENTER)
		processing.ellipse(0,0,value3,value3);
		processing.popMatrix();
		//Value 4
		processing.pushMatrix();
		processing.translate(startPointX,distanz*4);
		processing.fill(199,66,35,190);
		processing.ellipseMode(processing.CENTER)
		processing.ellipse(0,0,value4,value4);
		processing.popMatrix();
		// Year
		processing.pushMatrix();
		//processing.translate(startPointX,distanz*5);
		processing.fill(0);
		processing.text(year,startPointX-15,processing.height-5);
		processing.popMatrix();
		processing.popMatrix();
	};
	
	</script>
	
</head>
<body>
	<h2>Informationsvisualisierung</h2>
	<canvas id='myCanvas'></canvas>
	<div id="controls">
		<label for="scale">Vergrößern:</label>
		<input id="scale" type="range" min="0.49" max="4.00" step="0.01" value='1.00' />
		<label for="translateX">TranslateX:</label>
		<input id="translateX" type="range" min="1.00" max="2000.00" step="1.00" value='5.00' />
		<input id="value1" type="text" />
	</div>
</form>
</body>
</html>