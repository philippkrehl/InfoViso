<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>InfoV</title>
	<script src="libraries/jquery-1.9.1.min.js"></script>
	<script src="libraries/processing-1.4.1.min.js"></script>
	<script src="libraries/moment.min.js"></script>
	
	<script type="text/javascript">
	
	$( document ).ready(function() {
		
		var url = createRequestURL('content','6e499da47fcb281145e490fb6fba3d02028ba8c83af1f50383ee',null,null,'liebe',null,'1year',null,null);
		
	    $.ajax({
	       type: 'GET',
	        url: url,
	        contentType: "application/json",
	        dataType: 'jsonp',
	        success: function(data) { successCallback(data); }, 
	        error: function() { notSuccessCallback(); }
	    });
	    
	});
	
    function successCallback(data){
    	
    	var loveArray = new Array(); 
    	
    	$.each(data.facets.release_date, function(index, value){
    		if(index !== 'start' && index !== 'end' && index !== 'gap') {
    			//console.log(moment(index).format('YYYY')  + ': ' + value);
    			loveArray[moment(index).format('YYYY')] = value;
    			console.log(loveArray);
    		}
    	})
    	console.log(data.facets.release_date);
    }
    
    function notSuccessCallback(){
    	console.log('fail');
    }
    
    function createRequestURL(topic, key, sort, fields, query, limit, facet_date, offset, facet_field){
    	var url = 'http://api.zeit.de/';
    	
    	//content || keyword
    	if(typeof topic === 'string'){
    		url = url + topic;
    	};
    	
    	//API Key
    	if(typeof key === 'string'){
    		url = url + '?api_key=' + key;
    	};
    	
    	//release_date desc
    	if(typeof sort === 'string'){
    		url = url + '?sort=' + sort;
    	}; 
    	
       	// subtitle,uuid,title,href,release_date,uri,snippet,supertitle,teaser_title,teaser_text
    	if(typeof fields === 'string'){
    		url = url + '&fields=' + fields;
    	};
    	
       	// s. Domkumentation
    	if(typeof query === 'string'){
    		url = url + '&q=' + query;
    	};      	
    	
       	// limit the amount of matches to return
    	if(typeof limit === 'int'){
    		url = url + '&limit=' + limit;
    	};        	

       	// The facet_date parameter returns counts for the distribution over a specified date range
       	// facet_date	1day, 7day, 1month, 1year, 10year or any numerical variation
    	if(typeof facet_date === 'string'){
    		url = url + '&facet_date=' + facet_date;
    	}; 
       	
       	// offset for the list of matches
    	if(typeof offset === 'int'){
    		url = url + '&offset=' + offset;
    	}; 
       
       	// The facet_field parameter is used to get a frequency distribution for the different values of a field
       	// facet_field	keyword, author, series, department, product or any combination
    	if(typeof facet_field === 'string'){
    		url = url + '&facet_field=' + facet_field;
    	};
    		   	
       	return encodeURI(url)
    }
		
	</script>
</head>
<body>

<div id="container">
	
</div>

</body>
</html>